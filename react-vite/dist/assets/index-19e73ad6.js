import{b as c,r as m,e as k,u as w,c as F,f as y,j as s,g as b,F as E,h as M}from"./index-b5fc81fe.js";import{O as D}from"./OpenModalButton-94a933ea.js";import{R as u}from"./RenderMarkdown-185bed96.js";import{C as I}from"./Confirm-3997e31d.js";import{S as h}from"./Sidebar-ae7ae17a.js";function G(){var j,f,p,g,N,v,$;const d=(j=c(e=>e.session.user))==null?void 0:j.settings.font_size,l=(f=c(e=>e.session.user))==null?void 0:f.settings.theme,r=(p=c(e=>e.session.user))==null?void 0:p.settings.role,x=c(e=>e.session.user),t=c(e=>e.courses.courses),n=c(e=>e.lessons.lessons),[C,L]=m.useState(),{lessonId:o}=k(),a=w(),i=F();return m.useEffect(()=>{x||(i("/"),a(y()))},[i,a,x]),m.useEffect(()=>{(async()=>{await a(M(+o)).then(L(!0))})()},[a,o]),s.jsx(s.Fragment,{children:x&&s.jsxs("div",{children:[s.jsx("div",{className:`flex column between ${l}1`,children:s.jsx("main",{id:"main-container",className:"flex minh100 gap-60 mtop-229 ",children:C&&n&&((g=t==null?void 0:t.course)==null?void 0:g.title)&&s.jsxs(s.Fragment,{children:[r==="student"&&s.jsxs(s.Fragment,{children:[s.jsx(h,{selection:"lesson",course:t.course,lesson:+o,lessons:t.lessons}),s.jsxs("div",{id:"lesson-container",className:`flex column gap-40 ${l} font-${d} ${l}2`,children:[s.jsxs("div",{className:"flex between acenter",children:[s.jsx("h1",{children:n.title}),s.jsx("p",{children:n.type})]}),s.jsx(u,{text:n.text}),n.complete?s.jsx("p",{className:"aselfend",children:"Complete"}):s.jsx("button",{onClick:()=>a(b(+o)),className:"button wfit aselfend",children:"Mark as complete"})]})]}),r==="parent"&&s.jsx(s.Fragment,{children:n.children&&s.jsxs(s.Fragment,{children:[s.jsx(h,{selection:"lesson",course:t.course,lesson:+o,lessons:t.lessons}),s.jsxs("div",{id:"lesson-container",className:`flex column gap-40 ${l} font-${d} ${l}2`,children:[s.jsxs("div",{className:"flex between acenter",children:[s.jsx("h1",{children:(N=n.children[0][0])==null?void 0:N.title}),s.jsx("p",{children:(v=n.children[0][0])==null?void 0:v.type})]}),s.jsx(u,{text:($=n.children[0][0])==null?void 0:$.text}),n.children.map(e=>s.jsx("div",{className:"flex aselfend",children:e[0].complete?s.jsxs("p",{className:"aselfend",children:[e[0].student.name,": Complete"]}):s.jsxs("div",{className:"flex aselfend acenter gap-10",children:[s.jsxs("p",{children:[e[0].student.name,": "]}),s.jsx("button",{onClick:()=>a(b(+o,e=e[0].student.id)),className:"button wfit aselfend",children:"Mark as complete"})]})},`child:${e[0].id}`))]})]})}),(r==="teacher"||r==="admin")&&s.jsxs(s.Fragment,{children:[s.jsx(h,{selection:"lesson",course:t.course,lesson:+o,lessons:t.lessons,teacher:!0}),s.jsxs("div",{id:"lesson-container",className:`flex column gap-40 ${l} font-${d} ${l}2`,children:[s.jsxs("div",{className:"flex between acenter",children:[s.jsx("h1",{children:n.title}),s.jsx("p",{children:n.type})]}),s.jsx(u,{text:n.text}),s.jsxs("div",{className:"aselfend flex gap-15",children:[s.jsx("button",{className:"button",onClick:()=>i(`/courses/${t.course.id}/lessons/${o}/edit`),children:"Edit lesson"}),s.jsx(D,{modalComponent:s.jsx(I,{theme:l,navigate:()=>i(`/courses/${t.course.id}`),lessonId:+o}),buttonText:"Delete lesson",red:!0})]})]})]})]})})}),s.jsx(E,{})]})})}export{G as default};
