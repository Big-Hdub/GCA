import{b as j,r as t,u as L,c as M,C as z,D as B,j as s,S as G,F as I,E as J}from"./index-b5fc81fe.js";import{O as R}from"./OpenModalButton-94a933ea.js";import{S as T}from"./Sidebar-ae7ae17a.js";function Q(){var b,A,F;const U=(b=j(a=>a.session.user))==null?void 0:b.settings.font_size,n=(A=j(a=>a.session.user))==null?void 0:A.settings.theme,p=(F=j(a=>a.session.user))==null?void 0:F.settings.role,C=j(a=>a.session.user),e=j(a=>a.account.data),[v,q]=t.useState(""),[k,N]=t.useState(!1),[y,O]=t.useState(""),[r,W]=t.useState(""),[m,w]=t.useState({}),[l,u]=t.useState(""),[i,h]=t.useState(""),[c,f]=t.useState(""),[d,x]=t.useState(""),g=L(),E=M();t.useEffect(()=>{C||(E("/"),g(z()))},[E,g,C]),t.useEffect(()=>{g(B())},[g]),t.useEffect(()=>{e&&(e.student?(f(e.student.name.split(" ")[0]),h(e.student.username),u(e.student.email),x(e.student.age),N(!0)):e.parent?(f(e.parent.name.split(" ")[0]),h(e.parent.username),u(e.parent.email),x(e.parent.age),N(!0)):e.teacher?(f(e.teacher.name.split(" ")[0]),h(e.teacher.username),u(e.teacher.email),x(e.teacher.age),N(!0)):e.admin&&(f(e.admin.name.split(" ")[0]),h(e.admin.username),u(e.admin.email),x(e.admin.age),N(!0)))},[e]);const D=async()=>{w({});const a={};let $=0;const S={};if(v!==r&&(S.confirm="new password and confirm password must match.",$++),v===r&&r.length>0&&r.length<8&&(S.newpassword="password must have at least 8 characters.",$++),$>0)w(S);else{r.length>7&&(a.newPassword=r,a.password=y),e.student?(c!==e.student.name.split(" ")[0]&&(a.firstName=c),i!==e.student.username&&(a.username=i),l!==e.student.email&&(a.email=l),d!==e.student.age&&(a.age=d)):e.parent?(c!==e.parent.name.split(" ")[0]&&(a.firstName=c),i!==e.parent.username&&(a.username=i),l!==e.parent.email&&(a.email=l),d!==e.parent.age&&(a.age=d)):e.teacher&&(c!==e.teacher.name.split(" ")[0]&&(a.firstName=c),i!==e.teacher.username&&(a.username=i),l!==e.teacher.email&&(a.email=l),d!==e.teacher.age&&(a.age=d));const P=await g(J(JSON.stringify(a)));P.errors&&w(P.errors)}},o=a=>{w({}),a()};return s.jsxs("div",{children:[s.jsx("div",{className:`flex column between ${n}1`,children:s.jsxs("main",{id:"main-container",className:"flex mtop-229 minh100 gap-60",children:[s.jsx(T,{selection:"account"}),s.jsx("div",{id:"account-container",className:`flex column gap-25 aend padding-40 ${n} font-${U} ${n}2`,children:k&&s.jsxs(s.Fragment,{children:[p==="student"&&s.jsxs("p",{className:"aselfstart",children:["Welcome ",e==null?void 0:e.student.name,","]}),p==="parent"&&s.jsxs("p",{className:"aselfstart",children:["Welcome ",e==null?void 0:e.parent.name,","]}),p==="teacher"&&s.jsxs("p",{className:"aselfstart",children:["Welcome ",e==null?void 0:e.teacher.name,","]}),s.jsx("p",{className:"aselfstart",children:"Change account details below."}),s.jsxs("div",{className:"flex gap-15 acenter",children:[s.jsx("p",{children:"Name:"}),s.jsx("input",{type:"text",className:`${n}3 ${n} rad-10`,value:c,onChange:a=>o(()=>f(a.target.value)),required:!0})]}),s.jsxs("div",{className:"flex gap-15 acenter",children:[s.jsx("p",{children:"Age:"}),s.jsx("input",{type:"number",className:`${n}3 ${n} rad-10`,value:d,onChange:a=>o(()=>x(a.target.value)),required:!0})]}),s.jsxs("div",{className:"flex gap-15 acenter",children:[s.jsx("p",{children:"User name:"}),s.jsx("input",{type:"text",className:`${n}3 ${n} rad-10`,value:i,onChange:a=>o(()=>h(a.target.value)),required:!0})]}),s.jsxs("div",{className:"flex gap-15 acenter",children:[s.jsx("p",{children:"Email:"}),s.jsx("input",{type:"email",className:`${n}3 ${n} rad-10`,value:l,onChange:a=>o(()=>u(a.target.value)),required:!0})]}),p==="student"&&s.jsxs("div",{className:"flex gap-15",children:[s.jsx("p",{children:"Parents:"}),e.parents.length===1?s.jsx("p",{children:e.parents[0].name}):s.jsxs("div",{className:"flex column gap-10",children:[s.jsx("p",{children:e.parents[0].name}),s.jsx("p",{children:e.parents[1].name})]})]}),p==="parent"&&s.jsxs("div",{className:"flex column aend gap-10",children:[s.jsx("div",{className:"flex gap-15",children:e.children.length>0&&s.jsxs(s.Fragment,{children:[s.jsx("p",{children:e.children.length===1?"Child:":"Children:"}),s.jsx("div",{className:"flex column gap-10",children:e.children.length>0&&e.children.map(a=>s.jsx("div",{className:"flex gap-15 acenter between",children:s.jsx("p",{children:a.name})},`child:${a.id}`))})]})}),s.jsxs("p",{children:["Children enrolled: ",e.children.length]}),s.jsx(R,{modalComponent:s.jsx(G,{createStudent:!0}),buttonText:"add child"})]}),s.jsx("p",{className:"aselfstart",children:"Update your password?"}),s.jsxs("div",{className:"flex gap-15 acenter",children:[s.jsx("p",{children:"Current password:"}),s.jsx("input",{type:"password",className:`${n}3 ${n} rad-10`,placeholder:"password",value:y,onChange:a=>o(()=>O(a.target.value))})]}),m.password&&s.jsx("p",{className:"error font-20",children:m.password}),s.jsxs("div",{className:"flex gap-15 acenter",children:[s.jsx("p",{children:"New password:"}),s.jsx("input",{type:"password",className:`${n}3 ${n} rad-10`,placeholder:"new password",value:v,onChange:a=>o(()=>q(a.target.value))})]}),m.newpassword&&s.jsx("p",{className:"error font-20",children:m.newpassword}),s.jsxs("div",{className:"flex gap-15 acenter",children:[s.jsx("p",{children:"Confirm password:"}),s.jsx("input",{type:"password",className:`${n}3 ${n} rad-10`,placeholder:"confirm password",value:r,onChange:a=>o(()=>W(a.target.value))})]}),m.confirm&&s.jsx("p",{className:"error font-20",children:m.confirm}),s.jsx("button",{className:"button",onClick:D,children:"Save changes"})]})})]})}),s.jsx(I,{})]})}export{Q as default};
